---
import "@fontsource/inter";
import "../styles/global.css";
import Preloader from "../components/Preloader.astro";
import CustomCursor from "../components/CustomCursor.astro";

interface Props {
	title: string;
	description?: string;
}

const { title, description = "David - Full Stack Developer in Training" } =
	Astro.props;
---

<!doctype html>
<html lang="es" class="scroll-smooth">
	<head>
		<meta charset="UTF-8" />
		<script is:inline>
			const theme = (() => {
				if (
					typeof localStorage !== "undefined" &&
					localStorage.getItem("theme")
				) {
					return localStorage.getItem("theme");
				}
				if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
					return "dark";
				}
				return "light";
			})();

			if (theme === "light") {
				document.documentElement.classList.remove("dark");
			} else {
				document.documentElement.classList.add("dark");
			}
			document.documentElement.setAttribute("data-theme", theme);
			window.localStorage.setItem("theme", theme);
		</script>

		<script>
			import Lenis from "lenis";

			// Initialize Lenis
			const lenis = new Lenis({
				duration: 1.2,
				easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)),
				touchMultiplier: 2,
				infinite: false,
			});

			// Use requestAnimationFrame to update the scroll
			function raf(time: number) {
				lenis.raf(time);
				requestAnimationFrame(raf);
			}

			requestAnimationFrame(raf);

			// Optional: Bind Lenis to your links
			document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
				anchor.addEventListener("click", (e) => {
					e.preventDefault();
					const id = anchor.getAttribute("href");
					if (id && id !== "#") {
						const target = document.querySelector(id);
						if (target) {
							lenis.scrollTo(target as HTMLElement, {
								offset: -80, // Space for sticky navbar
							});
						}
					}
				});
			});
		</script>
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/svg+xml" href="/brand-logo.svg" />
		<meta name="generator" content={Astro.generator} />

		<!-- Primary Meta Tags -->
		<title>{title}</title>
		<meta name="title" content={title} />
		<meta name="description" content={description} />
		<meta name="author" content="David" />
		<meta
			name="keywords"
			content="David, Full Stack Developer, IngenierÃ­a de Software, IA, React, Astro, Portafolio, Programador"
		/>
		<meta name="robots" content="index, follow" />
		<meta name="theme-color" content="#1fa3de" />

		<!-- Open Graph / Facebook -->
		<meta property="og:type" content="website" />
		<meta property="og:url" content={Astro.url} />
		<meta property="og:title" content={title} />
		<meta property="og:description" content={description} />
		<meta property="og:image" content="/og-image.png" />

		<!-- Twitter -->
		<meta property="twitter:card" content="summary_large_image" />
		<meta property="twitter:url" content={Astro.url} />
		<meta property="twitter:title" content={title} />
		<meta property="twitter:description" content={description} />
		<meta property="twitter:image" content="/og-image.png" />

		<!-- Structured Data -->
		<script type="application/ld+json">
			{
				"@context": "https://schema.org",
				"@type": "Person",
				"name": "David",
				"jobTitle": "Full Stack Developer",
				"description": "Desarrollador enfocado en soluciones inteligentes y escalables.",
				"url": "https://david-portfolio.com",
				"sameAs": [
					"https://instagram.com/lizano.davidd",
					"https://github.com/Jerowaree"
				]
			}
		</script>
	</head>
	<body
		class="bg-base-100 text-base-content selection:bg-[#1fa3de]/20 selection:text-[#1fa3de] overflow-x-hidden antialiased"
	>
		<Preloader />
		<CustomCursor />
		<slot />
	</body>
</html>
